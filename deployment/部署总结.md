# ğŸ‰ éƒ¨ç½²åŒ…ç”Ÿæˆå®Œæˆ

## âœ… å·²ç”Ÿæˆæ–‡ä»¶æ€»è§ˆ

### ğŸ“¦ ç»Ÿè®¡ä¿¡æ¯
- **æ€»æ–‡ä»¶æ•°**: 21 ä¸ªé…ç½®/è„šæœ¬/æ–‡æ¡£æ–‡ä»¶
- **ç›®å½•å¤§å°**: 135 MB (å«å®Œæ•´æºç )
- **ç”Ÿæˆæ—¶é—´**: 2025-10-04

### ğŸ“ æ–‡ä»¶æ¸…å•

```
deployment/
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒ Docker æ–‡ä»¶ (3ä¸ª)
â”‚   â”œâ”€â”€ Dockerfile                 # å¤šé˜¶æ®µæ„å»ºé…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml         # å®¹å™¨ç¼–æ’é…ç½®
â”‚   â””â”€â”€ .dockerignore              # æ„å»ºæ’é™¤è§„åˆ™
â”‚
â”œâ”€â”€ ğŸ”§ éƒ¨ç½²è„šæœ¬ (4ä¸ª)
â”‚   â”œâ”€â”€ build.sh                   # æ„å»º AMD64 é•œåƒ
â”‚   â”œâ”€â”€ deploy.sh                  # å¯åŠ¨/é‡å¯å®¹å™¨
â”‚   â”œâ”€â”€ save-image.sh              # å¯¼å‡ºé•œåƒä¸º tar.gz
â”‚   â””â”€â”€ stop.sh                    # åœæ­¢å®¹å™¨
â”‚
â”œâ”€â”€ âš™ï¸ Nginx é…ç½® (3ä¸ª)
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â””â”€â”€ default.conf           # å®¹å™¨å†… Nginx é…ç½®
â”‚   â””â”€â”€ nginx-vhost/
â”‚       â”œâ”€â”€ group.adapt-learn.online.conf  # å®¿ä¸»æœºè™šæ‹Ÿä¸»æœºé…ç½®
â”‚       â””â”€â”€ ssl-setup.sh           # SSL è‡ªåŠ¨é…ç½®è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£ (4ä¸ª)
â”‚   â”œâ”€â”€ README.md                  # éƒ¨ç½²åŒ…æ€»è§ˆ
â”‚   â”œâ”€â”€ QUICKSTART.md              # 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²
â”‚   â”œâ”€â”€ DEPLOYMENT.md              # å®Œæ•´éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ CHECKLIST.md               # éƒ¨ç½²æ¸…å•ä¸æ¶æ„è¯´æ˜
â”‚
â””â”€â”€ ğŸ“ app/                        # å®Œæ•´é¡¹ç›®æºç  (135 MB)
```

## ğŸ¯ éƒ¨ç½²æ–¹æ¡ˆè¯´æ˜

### âœ… æ‚¨çš„éœ€æ±‚å·²å®Œå…¨å®ç°

1. âœ… **å­åŸŸåéƒ¨ç½²**: `group.adapt-learn.online` è®¿é—®æœ¬é¡¹ç›®
2. âœ… **IPç«¯å£è®¿é—®**: `121.40.124.135:8081` ç›´æ¥è®¿é—®
3. âœ… **ä¿ç•™åŸç«™ç‚¹**: `adapt-learn.online` ç»§ç»­è¿è¡ŒåŸç½‘ç«™
4. âœ… **DockeråŒ–éƒ¨ç½²**: å¤šé˜¶æ®µæ„å»º,è½»é‡åŒ–é•œåƒ
5. âœ… **AMD64æ¶æ„**: åœ¨ ARM64 Mac ä¸Šè·¨å¹³å°æ„å»º
6. âœ… **Podmanå…¼å®¹**: æ‰€æœ‰è„šæœ¬æ”¯æŒ Docker å’Œ Podman

### ğŸ—ï¸ éƒ¨ç½²æ¶æ„

```
äº’è”ç½‘
  â”‚
  â”œâ”€â†’ adapt-learn.online (80/443)
  â”‚     â””â”€â†’ åŸç½‘ç«™æœåŠ¡ (ä¿æŒä¸å˜)
  â”‚
  â”œâ”€â†’ group.adapt-learn.online (80/443)
  â”‚     â””â”€â†’ Nginx åå‘ä»£ç† (å®¿ä¸»æœº)
  â”‚           â””â”€â†’ http://127.0.0.1:8081
  â”‚                 â””â”€â†’ Podman å®¹å™¨
  â”‚                       â””â”€â†’ Nginx Alpine â†’ é™æ€æ–‡ä»¶
  â”‚
  â””â”€â†’ 121.40.124.135:8081
        â””â”€â†’ ç›´æ¥è®¿é—® Podman å®¹å™¨
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥: æœ¬åœ°æ„å»ºé•œåƒ (3-5åˆ†é’Ÿ)

```bash
cd deployment
./build.sh
```

è¿™å°†åœ¨æ‚¨çš„ ARM64 Mac ä¸Šè·¨å¹³å°æ„å»º AMD64 æ¶æ„çš„é•œåƒã€‚

### ç¬¬äºŒæ­¥: å¯¼å‡ºé•œåƒ

```bash
./save-image.sh
```

ç”Ÿæˆæ–‡ä»¶: `student-grouping-amd64.tar.gz` (çº¦ 50-80 MB)

### ç¬¬ä¸‰æ­¥: ä¸Šä¼ åˆ°æœåŠ¡å™¨

```bash
scp student-grouping-amd64.tar.gz root@121.40.124.135:/root/
```

### ç¬¬å››æ­¥: æœåŠ¡å™¨éƒ¨ç½²

SSH ç™»å½•æœåŠ¡å™¨:
```bash
ssh root@121.40.124.135

# å¯¼å…¥é•œåƒ
gunzip student-grouping-amd64.tar.gz
podman load -i student-grouping-amd64.tar

# å¯åŠ¨å®¹å™¨
podman run -d \
  --name student-grouping \
  -p 8081:80 \
  --restart unless-stopped \
  student-grouping:latest

# éªŒè¯
podman ps
curl http://localhost:8081
```

### ç¬¬äº”æ­¥: é…ç½®åŸŸåè®¿é—® (å¯é€‰)

#### 5.1 é…ç½® Nginx åå‘ä»£ç†

```bash
# ä¸Šä¼ é…ç½®æ–‡ä»¶
scp nginx-vhost/group.adapt-learn.online.conf \
  root@121.40.124.135:/etc/nginx/conf.d/

# åœ¨æœåŠ¡å™¨ä¸Š
sudo nginx -t
sudo systemctl reload nginx
sudo firewall-cmd --permanent --add-service={http,https}
sudo firewall-cmd --reload
```

#### 5.2 é…ç½® SSL è¯ä¹¦

```bash
# ä¸Šä¼ å¹¶è¿è¡Œ SSL è„šæœ¬
scp nginx-vhost/ssl-setup.sh root@121.40.124.135:/root/

# SSH åˆ°æœåŠ¡å™¨
ssh root@121.40.124.135

# ç¼–è¾‘è„šæœ¬ä¿®æ”¹é‚®ç®±,ç„¶åè¿è¡Œ
vim /root/ssl-setup.sh
sudo bash /root/ssl-setup.sh
```

## ğŸŒ è®¿é—®åœ°å€

éƒ¨ç½²å®Œæˆå:

- **ç›´æ¥ IP è®¿é—®** (ç«‹å³å¯ç”¨):
  - http://121.40.124.135:8081

- **åŸŸåè®¿é—®** (éœ€å®Œæˆç¬¬äº”æ­¥):
  - http://group.adapt-learn.online (è‡ªåŠ¨é‡å®šå‘ HTTPS)
  - https://group.adapt-learn.online (æ¨è)

- **åŸç«™ç‚¹** (ä¿æŒä¸å˜):
  - https://adapt-learn.online

## ğŸ“š è¯¦ç»†æ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” | é€‚åˆäººç¾¤ |
|------|------|----------|
| [QUICKSTART.md](QUICKSTART.md) | 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½² | æƒ³å¿«é€Ÿä¸Šæ‰‹çš„ç”¨æˆ· |
| [DEPLOYMENT.md](DEPLOYMENT.md) | å®Œæ•´éƒ¨ç½²æŒ‡å— | éœ€è¦äº†è§£æ‰€æœ‰ç»†èŠ‚çš„ç”¨æˆ· |
| [CHECKLIST.md](CHECKLIST.md) | éƒ¨ç½²æ¸…å•å’Œæ¶æ„ | éœ€è¦æ£€æŸ¥æ¸…å•çš„ç”¨æˆ· |
| [README.md](README.md) | éƒ¨ç½²åŒ…æ€»è§ˆ | é¦–æ¬¡æ¥è§¦çš„ç”¨æˆ· |

## ğŸ”§ æ ¸å¿ƒç‰¹æ€§

### Docker é•œåƒç‰¹æ€§
- âœ… å¤šé˜¶æ®µæ„å»º (Node.js ç¼–è¯‘ + Nginx è¿è¡Œ)
- âœ… è½»é‡åŒ–é•œåƒ (åŸºäº Alpine Linux)
- âœ… AMD64 æ¶æ„ (å…¼å®¹æœåŠ¡å™¨)
- âœ… å¥åº·æ£€æŸ¥ (è‡ªåŠ¨é‡å¯å¤±è´¥å®¹å™¨)

### Nginx é…ç½®ç‰¹æ€§
- âœ… SPA è·¯ç”±æ”¯æŒ (try_files fallback)
- âœ… æ–‡ä»¶ä¸Šä¼ é™åˆ¶ 50MB (æ”¯æŒ Excel)
- âœ… Gzip å‹ç¼©
- âœ… é™æ€èµ„æºç¼“å­˜
- âœ… å®‰å…¨å“åº”å¤´

### éƒ¨ç½²è„šæœ¬ç‰¹æ€§
- âœ… Docker/Podman è‡ªåŠ¨æ£€æµ‹
- âœ… è·¨å¹³å°æ„å»º (ARM64 â†’ AMD64)
- âœ… ä¸€é”®æ„å»º/éƒ¨ç½²/å¯¼å‡º
- âœ… å½©è‰²è¾“å‡º,æ˜“äºç†è§£

## ğŸ”’ å®‰å…¨æ€§

- âœ… HTTPS/SSL æ”¯æŒ (Let's Encrypt å…è´¹è¯ä¹¦)
- âœ… è‡ªåŠ¨ HTTP â†’ HTTPS é‡å®šå‘
- âœ… å®‰å…¨å“åº”å¤´ (HSTS, X-Frame-Options, CSP)
- âœ… å®¹å™¨éš”ç¦»
- âœ… æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
- âœ… SSL è¯ä¹¦è‡ªåŠ¨ç»­æœŸ

## ğŸ“Š æŠ€æœ¯æ ˆ

### æ„å»ºç¯å¢ƒ
- macOS (ARM64)
- Docker / Podman
- Node.js 20.18.1
- Vite 7.x

### è¿è¡Œç¯å¢ƒ
- Alibaba Cloud Linux 3.2104 LTS
- AMD64 (x86_64)
- Podman
- Nginx 1.27 (Alpine)

## ğŸ†˜ æ•…éšœæ’æŸ¥

å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆè¯¦è§ [DEPLOYMENT.md#æ•…éšœæ’æŸ¥](DEPLOYMENT.md#æ•…éšœæ’æŸ¥)

å¿«é€Ÿè¯Šæ–­å‘½ä»¤:
```bash
# å®¹å™¨çŠ¶æ€
podman ps -a
podman logs student-grouping

# ç½‘ç»œæ£€æŸ¥
ss -tlnp | grep 8081
curl http://localhost:8081

# Nginx æ£€æŸ¥
sudo nginx -t
sudo systemctl status nginx

# DNS æ£€æŸ¥
dig group.adapt-learn.online
```

## ğŸ”„ æ›´æ–°ç»´æŠ¤

æ›´æ–°åº”ç”¨ç‰ˆæœ¬:
```bash
# æœ¬åœ°
cd deployment
./build.sh
./save-image.sh
scp student-grouping-amd64.tar.gz root@121.40.124.135:/root/

# æœåŠ¡å™¨
ssh root@121.40.124.135
podman stop student-grouping
podman rm student-grouping
gunzip -f student-grouping-amd64.tar.gz
podman load -i student-grouping-amd64.tar
podman run -d --name student-grouping -p 8081:80 --restart unless-stopped student-grouping:latest
```

## âœ¨ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¯åš** (æ¨è):
   - è¿è¡Œ `./build.sh` æ„å»ºé•œåƒ
   - è¿è¡Œ `./deploy.sh` æœ¬åœ°æµ‹è¯•
   - è®¿é—® http://localhost:8081 éªŒè¯

2. **å‡†å¤‡éƒ¨ç½²**:
   - è¿è¡Œ `./save-image.sh` å¯¼å‡ºé•œåƒ
   - ä¸Šä¼ é•œåƒåˆ°æœåŠ¡å™¨
   - åœ¨æœåŠ¡å™¨ä¸Šå¯¼å…¥å¹¶å¯åŠ¨

3. **å®Œå–„éƒ¨ç½²** (å¯é€‰):
   - é…ç½® Nginx åå‘ä»£ç†
   - é…ç½® SSL è¯ä¹¦
   - è®¾ç½®åŸŸåè§£æ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜,è¯·æ£€æŸ¥:
1. å®¹å™¨æ—¥å¿—: `podman logs student-grouping`
2. Nginx æ—¥å¿—: `/var/log/nginx/error.log`
3. è¯¦ç»†æ–‡æ¡£: [DEPLOYMENT.md](DEPLOYMENT.md)

---

## ğŸ“‹ éƒ¨ç½²éªŒè¯æ¸…å•

- [ ] é•œåƒæ„å»ºæˆåŠŸ (`./build.sh`)
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡ (http://localhost:8081)
- [ ] é•œåƒå¯¼å‡ºæˆåŠŸ (`./save-image.sh`)
- [ ] é•œåƒä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] æœåŠ¡å™¨å¯¼å…¥é•œåƒæˆåŠŸ
- [ ] å®¹å™¨å¯åŠ¨æˆåŠŸ (`podman ps`)
- [ ] IP è®¿é—®æ­£å¸¸ (http://121.40.124.135:8081)
- [ ] Nginx é…ç½®æ­£ç¡® (`nginx -t`)
- [ ] é˜²ç«å¢™è§„åˆ™å·²æ·»åŠ 
- [ ] SSL è¯ä¹¦é…ç½®æˆåŠŸ (å¯é€‰)
- [ ] åŸŸåè®¿é—®æ­£å¸¸ (https://group.adapt-learn.online)
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡ (ä¸Šä¼ /åˆ†ç»„/å¯¼å‡º)

---

**éƒ¨ç½²åŒ…ç‰ˆæœ¬**: 1.0
**ç”Ÿæˆæ—¥æœŸ**: 2025-10-04
**ç›®æ ‡ç³»ç»Ÿ**: Alibaba Cloud Linux 3.2104 LTS (AMD64)
**ç›®æ ‡æœåŠ¡å™¨**: 121.40.124.135 (group.adapt-learn.online)

ğŸ‰ **éƒ¨ç½²åŒ…å·²å‡†å¤‡å°±ç»ª,ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©!**
